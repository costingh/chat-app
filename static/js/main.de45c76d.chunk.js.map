{"version":3,"sources":["reducers/auth.js","reducers/message.js","reducers/index.js","actions/types.js","store.js","services/auth-header.js","utils/baseUrl.js","services/auth.service.js","components/Login.js","actions/auth.js","components/Register.js","services/user.service.js","components/Home.js","components/Profile.js","common/EventBus.js","services/conversations.service.js","services/messages.service.js","components/AddNewContact.js","components/MessageList.js","utils/utils.js","components/ChatContent.js","components/ChatInfos.js","components/Chat.js","components/BoardUser.js","helpers/history.js","common/AuthVerify.js","App.js","actions/message.js","serviceWorker.js","index.js"],"names":["user","JSON","parse","localStorage","getItem","initialState","isLoggedIn","combineReducers","auth","state","action","type","payload","message","middleware","thunk","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","authHeader","accessToken","Authorization","API_URL","BASE_URL","username","email","password","axios","post","then","response","data","setItem","stringify","removeItem","get","headers","userId","status","required","value","className","role","Login","props","form","useRef","checkBtn","useState","setUsername","setPassword","loading","setLoading","useSelector","dispatch","useDispatch","to","src","alt","onSubmit","e","preventDefault","current","validateAll","context","_errors","length","AuthService","Promise","resolve","error","toString","reject","login","history","push","window","location","reload","catch","ref","htmlFor","name","onChange","target","validations","disabled","style","display","validEmail","isEmail","vusername","vpassword","Register","setEmail","successful","setSuccessful","register","Home","content","setContent","useEffect","UserService","_content","Profile","currentUser","substring","substr","id","roles","map","index","key","eventBus","on","event","callback","document","addEventListener","detail","dispatchEvent","CustomEvent","remove","removeEventListener","conversation","conversationId","delete","AddNewContact","showAddContactForm","onClick","MessageList","currentChatContact","setCurrentChatContact","setCurrentConversation","hideAddContactForm","contactForm","onlineUsersIds","inputRef","filteredList","setFilteredList","allUsersList","setAllUsersList","conversations","setConversations","contacts","setContacts","realTimeContacts","setRealTimeContacts","timeout","timeout0","setTimeout","contactList","contact","includes","resp","console","log","updatedContact","clearTimeout","ConversationsService","err","users","changeActiveUser","querySelector","classList","add","currentConversationId","url","URL","href","searchParams","set","pushState","addQueryParam","getNewContactDetails","participant","allContacts","a","participantId","participantOneId","participantTwoId","userResponse","MessagesService","messageResponse","lastMessage","conv","cursor","marginBottom","xmlns","width","height","viewBox","d","body","contains","fill","placeholder","autoComplete","filteredUsers","filter","toLowerCase","startsWith","newContact","find","alert","newConversation","addToContacts","profilePicture","marginTop","textAlign","getQueryParam","ChatContent","messages","setMessages","sendMessage","currentConversation","logOut","messageRef","chat","innerWidth","data-online","profile","clientWidth","cx","cy","r","from","newMessage","ChatInfos","socialMedias","social","link","activities","activity","padding","borderRadius","background","color","maxWidth","margin","Chat","useHistory","CONNECTED_USER","description","setContactForm","setOnlineUsersIds","ws","stomp","messagesSubscriptions","SockJS","Stomp","over","reconnect_delay","connect","frame","connectedUser","send","onlineContactsSubscription","subscribe","connectAction","offlineContactsSubscription","disconnectAction","onlineUser","newMessagesSubscription","chatActions","close","onbeforeunload","disconnectedUser","disconnect","subscription","unsubscribe","EventBus","BoardUser","showChat","setShowChat","createBrowserHistory","AuthVerify","listen","token","atob","split","parseJwt","exp","Date","now","App","setShowModeratorBoard","setShowAdminBoard","useCallback","exact","path","component","Boolean","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.de45c76d.chunk.js","sourcesContent":["import {\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  LOGOUT,\n} from \"../actions/types\";\n\nconst user = JSON.parse(localStorage.getItem(\"user\"));\n\nconst initialState = user\n  ? { isLoggedIn: true, user }\n  : { isLoggedIn: false, user: null };\n\nexport default function (state = initialState, action) {\n  const { type, payload } = action;\n\n  switch (type) {\n    case REGISTER_SUCCESS:\n      return {\n        ...state,\n        isLoggedIn: false,\n      };\n    case REGISTER_FAIL:\n      return {\n        ...state,\n        isLoggedIn: false,\n      };\n    case LOGIN_SUCCESS:\n      return {\n        ...state,\n        isLoggedIn: true,\n        user: payload.user,\n      };\n    case LOGIN_FAIL:\n      return {\n        ...state,\n        isLoggedIn: false,\n        user: null,\n      };\n    case LOGOUT:\n      return {\n        ...state,\n        isLoggedIn: false,\n        user: null,\n      };\n    default:\n      return state;\n  }\n}\n","import { SET_MESSAGE, CLEAR_MESSAGE } from \"../actions/types\";\n\nconst initialState = {};\n\nexport default function (state = initialState, action) {\n  const { type, payload } = action;\n\n  switch (type) {\n    case SET_MESSAGE:\n      return { message: payload };\n\n    case CLEAR_MESSAGE:\n      return { message: \"\" };\n\n    default:\n      return state;\n  }\n}\n","import { combineReducers } from \"redux\";\nimport auth from \"./auth\";\nimport message from \"./message\";\n\nexport default combineReducers({\n  auth,\n  message,\n});\n","export const REGISTER_SUCCESS = \"REGISTER_SUCCESS\";\nexport const REGISTER_FAIL = \"REGISTER_FAIL\";\nexport const LOGIN_SUCCESS = \"LOGIN_SUCCESS\";\nexport const LOGIN_FAIL = \"LOGIN_FAIL\";\nexport const LOGOUT = \"LOGOUT\";\n\nexport const SET_MESSAGE = \"SET_MESSAGE\";\nexport const CLEAR_MESSAGE = \"CLEAR_MESSAGE\";\n","import { createStore, applyMiddleware } from \"redux\";\nimport { composeWithDevTools } from \"redux-devtools-extension\";\nimport thunk from \"redux-thunk\";\nimport rootReducer from \"./reducers\";\n\nconst middleware = [thunk];\n\nconst store = createStore(\n  rootReducer,\n  composeWithDevTools(applyMiddleware(...middleware))\n);\n\nexport default store;\n","export default function authHeader() {\n  const user = JSON.parse(localStorage.getItem(\"user\"));\n\n  if (user && user.accessToken) {\n    // For Spring Boot back-end\n    return { Authorization: \"Bearer \" + user.accessToken };\n\n    // for Node.js Express back-end\n    // return { \"x-access-token\": user.accessToken };\n  } else {\n    return {};\n  }\n}\n","export default \"https://chat-app-spring-boot.herokuapp.com/\"","import axios from \"axios\";\nimport authHeader from \"./auth-header\";\nimport BASE_URL from '../utils/baseUrl';\n\nconst API_URL = BASE_URL + \"api/auth/\";\n\nconst register = (username, email, password) => {\n  return axios.post(API_URL + \"signup\", {\n    username,\n    email,\n    password,\n  });\n};\n\nconst login = (username, password) => {\n  return axios\n    .post(API_URL + \"signin\", {\n      username,\n      password,\n    })\n    .then((response) => {\n      if (response.data.accessToken) {\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\n      }\n\n      return response.data;\n    });\n};\n\nconst logout = () => {\n  localStorage.removeItem(\"user\");\n};\n\nconst getAllUsers = () => {\n  return axios.get(API_URL + \"all\", { headers: authHeader() });\n};\n\nconst getUser = (userId) => {\n  return axios.get(API_URL + `user/${userId}`, { headers: authHeader() });\n};\n\nconst updateStatus = (userId, status) => {\n  return axios.post(API_URL + `user/update-status`, {userId, status});\n};\n\nexport default {\n  register,\n  login,\n  logout,\n  getAllUsers,\n  getUser,\n  updateStatus\n};\n","import React, { useState, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Redirect } from 'react-router-dom';\n\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\n\nimport { login } from \"../actions/auth\";\nimport {Link } from \"react-router-dom\";\n\nconst required = (value) => {\n  if (!value) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        This field is required!\n      </div>\n    );\n  }\n};\n\nconst Login = (props) => {\n  const form = useRef();\n  const checkBtn = useRef();\n\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const { isLoggedIn } = useSelector(state => state.auth);\n  const { message } = useSelector(state => state.message);\n\n  const dispatch = useDispatch();\n\n  const onChangeUsername = (e) => {\n    const username = e.target.value;\n    setUsername(username);\n  };\n\n  const onChangePassword = (e) => {\n    const password = e.target.value;\n    setPassword(password);\n  };\n\n  const handleLogin = (e) => {\n    e.preventDefault();\n\n    setLoading(true);\n\n    form.current.validateAll();\n\n    if (checkBtn.current.context._errors.length === 0) {\n      dispatch(login(username, password))\n        .then(() => {\n          props.history.push(\"/chat\");\n          window.location.reload();\n        })\n        .catch(() => {\n          setLoading(false);\n        });\n    } else {\n      setLoading(false);\n    }\n  };\n\n  if (isLoggedIn) {\n    return <Redirect to=\"/chat-app/chat\" />;\n  }\n\n  return (\n    <div className=\"col-md-12\">\n      <div className=\"card card-container\">\n        <img\n          src=\"/ssl.gstatic.com/accounts/ui/avatar_2x.png\"\n          alt=\"profile-img\"\n          className=\"profile-img-card\"\n        />\n\n        <Form onSubmit={handleLogin} ref={form}>\n          <div className=\"form-group\">\n            <label htmlFor=\"username\">Username</label>\n            <Input\n              type=\"text\"\n              className=\"form-control\"\n              name=\"username\"\n              value={username}\n              onChange={onChangeUsername}\n              validations={[required]}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"password\">Password</label>\n            <Input\n              type=\"password\"\n              className=\"form-control\"\n              name=\"password\"\n              value={password}\n              onChange={onChangePassword}\n              validations={[required]}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <button className=\"btn btn-primary btn-block\" disabled={loading}>\n              {loading && (\n                <span className=\"spinner-border spinner-border-sm\"></span>\n              )}\n              <span>Login</span>\n            </button>\n          </div>\n\n          {message && (\n            <div className=\"form-group\">\n              <div className=\"alert alert-danger\" role=\"alert\">\n                {message}\n              </div>\n            </div>\n          )}\n          <CheckButton style={{ display: \"none\" }} ref={checkBtn} />\n        </Form>\n        <div className=\"text-center\">\n          <p>New member?</p>\n          <Link to={\"/chat-app/register\"}>\n            Sign up now\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n","import {\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  LOGOUT,\n  SET_MESSAGE,\n} from \"./types\";\n\nimport AuthService from \"../services/auth.service\";\n\nexport const register = (username, email, password) => (dispatch) => {\n  return AuthService.register(username, email, password).then(\n    (response) => {\n      dispatch({\n        type: REGISTER_SUCCESS,\n      });\n\n      dispatch({\n        type: SET_MESSAGE,\n        payload: response.data.message,\n      });\n\n      return Promise.resolve();\n    },\n    (error) => {\n      const message =\n        (error.response &&\n          error.response.data &&\n          error.response.data.message) ||\n        error.message ||\n        error.toString();\n\n      dispatch({\n        type: REGISTER_FAIL,\n      });\n\n      dispatch({\n        type: SET_MESSAGE,\n        payload: message,\n      });\n\n      return Promise.reject();\n    }\n  );\n};\n\nexport const login = (username, password) => (dispatch) => {\n  return AuthService.login(username, password).then(\n    (data) => {\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: { user: data },\n      });\n\n      return Promise.resolve();\n    },\n    (error) => {\n      const message =\n        (error.response &&\n          error.response.data &&\n          error.response.data.message) ||\n        error.message ||\n        error.toString();\n\n      dispatch({\n        type: LOGIN_FAIL,\n      });\n\n      dispatch({\n        type: SET_MESSAGE,\n        payload: message,\n      });\n\n      return Promise.reject();\n    }\n  );\n};\n\nexport const logout = () => (dispatch) => {\n  AuthService.logout();\n\n  dispatch({\n    type: LOGOUT,\n  });\n};\n","import React, { useState, useRef } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport Form from \"react-validation/build/form\";\nimport Input from \"react-validation/build/input\";\nimport CheckButton from \"react-validation/build/button\";\nimport { isEmail } from \"validator\";\n\nimport { register } from \"../actions/auth\";\nimport {Link } from \"react-router-dom\";\n\nconst required = (value) => {\n  if (!value) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        This field is required!\n      </div>\n    );\n  }\n};\n\nconst validEmail = (value) => {\n  if (!isEmail(value)) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        This is not a valid email.\n      </div>\n    );\n  }\n};\n\nconst vusername = (value) => {\n  if (value.length < 3 || value.length > 20) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        The username must be between 3 and 20 characters.\n      </div>\n    );\n  }\n};\n\nconst vpassword = (value) => {\n  if (value.length < 6 || value.length > 40) {\n    return (\n      <div className=\"alert alert-danger\" role=\"alert\">\n        The password must be between 6 and 40 characters.\n      </div>\n    );\n  }\n};\n\nconst Register = () => {\n  const form = useRef();\n  const checkBtn = useRef();\n\n  const [username, setUsername] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [successful, setSuccessful] = useState(false);\n\n  const { message } = useSelector(state => state.message);\n  const dispatch = useDispatch();\n\n  const onChangeUsername = (e) => {\n    const username = e.target.value;\n    setUsername(username);\n  };\n\n  const onChangeEmail = (e) => {\n    const email = e.target.value;\n    setEmail(email);\n  };\n\n  const onChangePassword = (e) => {\n    const password = e.target.value;\n    setPassword(password);\n  };\n\n  const handleRegister = (e) => {\n    e.preventDefault();\n\n    setSuccessful(false);\n\n    form.current.validateAll();\n\n    if (checkBtn.current.context._errors.length === 0) {\n      dispatch(register(username, email, password))\n        .then(() => {\n          setSuccessful(true);\n        })\n        .catch(() => {\n          setSuccessful(false);\n        });\n    }\n  };\n\n  return (\n    <div className=\"col-md-12\">\n      <div className=\"card card-container\">\n        <img\n          src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\n          alt=\"profile-img\"\n          className=\"profile-img-card\"\n        />\n\n        <Form onSubmit={handleRegister} ref={form}>\n          {!successful && (\n            <div>\n              <div className=\"form-group\">\n                <label htmlFor=\"username\">Username</label>\n                <Input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"username\"\n                  value={username}\n                  onChange={onChangeUsername}\n                  validations={[required, vusername]}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"email\">Email</label>\n                <Input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"email\"\n                  value={email}\n                  onChange={onChangeEmail}\n                  validations={[required, validEmail]}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <label htmlFor=\"password\">Password</label>\n                <Input\n                  type=\"password\"\n                  className=\"form-control\"\n                  name=\"password\"\n                  value={password}\n                  onChange={onChangePassword}\n                  validations={[required, vpassword]}\n                />\n              </div>\n\n              <div className=\"form-group\">\n                <button className=\"btn btn-primary btn-block\">Sign Up</button>\n              </div>\n            </div>\n          )}\n\n          {message && (\n            <div className=\"form-group\">\n              <div className={ successful ? \"alert alert-success\" : \"alert alert-danger\" } role=\"alert\">\n                {message}\n              </div>\n            </div>\n          )}\n          <CheckButton style={{ display: \"none\" }} ref={checkBtn} />\n        </Form>\n        <div className=\"text-center\">\n          <p>Already have an account?</p>\n          <Link to={\"/chat-app/login\"}>\n            Login\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Register;\n","import axios from \"axios\";\r\nimport authHeader from \"./auth-header\";\r\nimport BASE_URL from '../utils/baseUrl';\r\n\r\nconst API_URL = BASE_URL + \"api/test/\";\r\n\r\nconst getPublicContent = () => {\r\n  return axios.get(API_URL + \"all\");\r\n};\r\n\r\nconst getUserBoard = () => {\r\n  return axios.get(API_URL + \"user\", { headers: authHeader() });\r\n};\r\n\r\nconst getModeratorBoard = () => {\r\n  return axios.get(API_URL + \"mod\", { headers: authHeader() });\r\n};\r\n\r\nconst getAdminBoard = () => {\r\n  return axios.get(API_URL + \"admin\", { headers: authHeader() });\r\n};\r\n\r\nexport default {\r\n  getPublicContent,\r\n  getUserBoard,\r\n  getModeratorBoard,\r\n  getAdminBoard,\r\n};","import React, { useState, useEffect } from \"react\";\n\nimport UserService from \"../services/user.service\";\n\nconst Home = () => {\n  const [content, setContent] = useState(\"\");\n\n  useEffect(() => {\n    UserService.getPublicContent().then(\n      (response) => {\n        setContent(response.data);\n      },\n      (error) => {\n        const _content =\n          (error.response && error.response.data) ||\n          error.message ||\n          error.toString();\n\n        setContent(_content);\n      }\n    );\n  }, []);\n\n  return (\n    <div className=\"container\">\n      <header className=\"jumbotron\">\n        <h3>{content}</h3>\n      </header>\n    </div>\n  );\n};\n\nexport default Home;\n","import React from \"react\";\nimport { Redirect } from 'react-router-dom';\nimport { useSelector } from \"react-redux\";\n\nconst Profile = () => {\n  const { user: currentUser } = useSelector((state) => state.auth);\n\n  if (!currentUser) {\n    return <Redirect to=\"/login\" />;\n  }\n\n  return (\n    <div className=\"container\">\n      <header className=\"jumbotron\">\n        <h3>\n          <strong>{currentUser.username}</strong> Profile\n        </h3>\n      </header>\n      <p>\n        <strong>Token:</strong> {currentUser.accessToken.substring(0, 20)} ...{\" \"}\n        {currentUser.accessToken.substr(currentUser.accessToken.length - 20)}\n      </p>\n      <p>\n        <strong>Id:</strong> {currentUser.id}\n      </p>\n      <p>\n        <strong>Email:</strong> {currentUser.email}\n      </p>\n      <strong>Authorities:</strong>\n      <ul>\n        {currentUser.roles &&\n          currentUser.roles.map((role, index) => <li key={index}>{role}</li>)}\n      </ul>\n    </div>\n  );\n};\n\nexport default Profile;\n","const eventBus = {\n  on(event, callback) {\n    document.addEventListener(event, (e) => callback(e.detail));\n  },\n  dispatch(event, data) {\n    document.dispatchEvent(new CustomEvent(event, { detail: data }));\n  },\n  remove(event, callback) {\n    document.removeEventListener(event, callback);\n  },\n};\n\nexport default eventBus;\n","import axios from \"axios\";\r\nimport authHeader from \"./auth-header\";\r\nimport BASE_URL from '../utils/baseUrl';\r\n\r\nconst API_URL = BASE_URL + \"api/conversation/\";\r\n\r\nconst createConversation = (conversation) => {\r\n  return axios.post(API_URL + \"add\", conversation, { headers: authHeader() });\r\n};\r\n\r\nconst getAUserConversations = (userId) => {\r\n  return axios.get(API_URL + `all/${userId}`, { headers: authHeader() });\r\n};\r\n\r\nconst getAllConversations = () => {\r\n  return axios.get(API_URL + 'all', { headers: authHeader() });\r\n};\r\n\r\nconst getConversation = (conversationId) => {\r\n  return axios.get(API_URL + `${conversationId}`, { headers: authHeader() });\r\n};\r\n\r\nconst deleteConversation = (conversationId) => {\r\n  return axios.delete(API_URL + `delete/${conversationId}`, { headers: authHeader() });\r\n};\r\n\r\nexport default {\r\n    createConversation,\r\n    getAUserConversations,\r\n    getAllConversations,\r\n    getConversation,\r\n    deleteConversation\r\n};","import axios from \"axios\";\r\nimport authHeader from \"./auth-header\";\r\nimport BASE_URL from '../utils/baseUrl';\r\n\r\nconst API_URL = BASE_URL + \"api/messages/\";\r\n\r\nconst getAllMessagesFromConversation = (conversationId) => {\r\n  return axios.get(API_URL + `all-messages/${conversationId}`, { headers: authHeader() });\r\n};\r\n\r\nconst getLastMessageFromConversation = (conversationId) => {\r\n  return axios.get(API_URL + `last-message/${conversationId}`, { headers: authHeader() });\r\n};\r\n\r\nexport default {\r\n    getAllMessagesFromConversation,\r\n    getLastMessageFromConversation\r\n};","import React from 'react'\r\n\r\nfunction AddNewContact({showAddContactForm}) {\r\n    return (\r\n        <div className=\"add_contact--btn\" onClick={showAddContactForm}>Add new contact </div>\r\n    )\r\n}\r\n\r\nexport default AddNewContact\r\n","import React, {useState, useRef, useEffect} from 'react'\r\nimport AuthService from \"../services/auth.service\"\r\nimport ConversationsService from \"../services/conversations.service\"\r\nimport MessagesService from '../services/messages.service';\r\nimport UserService from '../services/auth.service';\r\nimport AddNewContact from './AddNewContact';\r\n\r\nfunction MessageList({currentChatContact, setCurrentChatContact, currentUser, setCurrentConversation, hideAddContactForm, contactForm, showAddContactForm, onlineUsersIds}) {\r\n    const inputRef = useRef();\r\n\r\n    const [filteredList, setFilteredList] = useState([]);\r\n    const [allUsersList, setAllUsersList] = useState([]);\r\n    const [conversations, setConversations] = useState([]);\r\n    const [contacts, setContacts] = useState([]);\r\n    const [realTimeContacts, setRealTimeContacts] = useState([]);\r\n\r\n    useEffect(() => {\r\n        if(contacts.length !== 0) {\r\n            setRealTimeContacts(contacts)\r\n        }\r\n    }, [contacts])\r\n\r\n    useEffect(() => {\r\n        let timeout;\r\n        const timeout0 = setTimeout(() => {\r\n            const contactList = [];\r\n\r\n            contacts.map(contact => {\r\n                if(contact.status === 'online') {\r\n                    if(onlineUsersIds.includes(contact.id)) {\r\n                        contactList.push(contact)\r\n                       // console.log('User is online and in array')\r\n                    }\r\n                    else {\r\n                        // console.log('User is only but not in array')\r\n                        contactList.push(contact)\r\n                    }\r\n                } else {\r\n                    if(!onlineUsersIds.includes(contact.id)) {\r\n                        // console.log('User is offline but not in array')\r\n                        contactList.push(contact)   \r\n                    }\r\n                    else {\r\n                        // console.log('User is offline but in array')\r\n                        UserService.updateStatus(contact.id, 'online')\r\n                            .then((resp) => console.log(resp))\r\n\r\n                        let updatedContact = {...contact};\r\n                        updatedContact.status = 'online'\r\n                        contactList.push(updatedContact)\r\n                    }\r\n                }\r\n            })\r\n            \r\n            timeout = setTimeout(() => {\r\n                setRealTimeContacts(contactList);\r\n            }, 1000)\r\n        }, 3000)\r\n\r\n        return () => {\r\n            clearTimeout(timeout);\r\n            clearTimeout(timeout0);\r\n        }\r\n    }, [onlineUsersIds, contacts])\r\n\r\n    useEffect(() => {\r\n        ConversationsService.getAUserConversations(currentUser.id)\r\n            .then((resp) => {setConversations(resp.data)})\r\n            .catch((err) => console.log(err))\r\n    }, [currentUser.id])\r\n\r\n    useEffect(() => {\r\n        if(contactForm) {\r\n            AuthService.getAllUsers()\r\n                .then((users) => {\r\n                    setAllUsersList(users.data)\r\n                    setFilteredList(users.data)\r\n                })\r\n                .catch((err) => console.log(err))\r\n        }\r\n    }, [contactForm])\r\n\r\n    const addQueryParam = (key, value) => {\r\n        const url = new URL(window.location.href);\r\n        url.searchParams.set(key, value);\r\n        window.history.pushState({}, '', url.toString());\r\n    };\r\n\r\n    const changeActiveUser = (user) => {\r\n        const chat = document.querySelector('.chat');\r\n        chat.classList.add('chat--show')\r\n\r\n        setCurrentChatContact(user);\r\n        const currentConversationId = user.conversationId;\r\n        setCurrentConversation(currentConversationId);\r\n        addQueryParam('conversation', currentConversationId);\r\n    }\r\n\r\n    const handleInputChange = (event) => {\r\n        if(contactForm && event.target.value !== '') {\r\n            const filteredUsers = allUsersList.filter(user => user.username.toLowerCase().startsWith(event.target.value.toLowerCase()));\r\n            setFilteredList(filteredUsers)\r\n        }\r\n        if(event.target.value === '') setFilteredList(allUsersList)\r\n    }\r\n\r\n    const addToContacts = (newContact) => {\r\n        const found = contacts.find(contact => contact.id === newContact.id);\r\n        if(found) {\r\n            alert('Contact already exists!');\r\n            return;\r\n        }\r\n        else {\r\n            const newConversation = {\r\n                participantOneId: currentUser.id,\r\n                participantTwoId: newContact.id\r\n            };\r\n\r\n            // create a new conversation\r\n            // this request retrieves an object with fields: id, participantOneId, participantTwoId, createdAt\r\n            ConversationsService.createConversation(newConversation)\r\n                .then((newConversation) => {\r\n                    // get the new contact user, to be displayed in messageList component\r\n                    // thi user id is participantTwoId\r\n                    UserService.getUser(newConversation.data.participantTwoId)\r\n                        .then((user) => {\r\n                            // add the conversationId field to the new user\r\n                            // then add it to state (no need to refresh the page to display new added contact)\r\n                            const newContact = {\r\n                                conversationId: newConversation.data.id,\r\n                                ...user.data\r\n                            }\r\n                            setContacts(contacts => [...contacts, newContact])\r\n                        }) \r\n                        .catch((err) => console.log(err))\r\n                }) \r\n                .catch((err) => console.log(err))\r\n    \r\n            hideAddContactForm()\r\n            inputRef.current.value = ''\r\n        }\r\n    }\r\n\r\n    const getNewContactDetails = async (conversation, participant, allContacts) => {\r\n        let participantId = participant === 'one' ? conversation.participantOneId : conversation.participantTwoId;\r\n        try {\r\n          const user = AuthService.getUser(participantId);\r\n          user.then((userResponse) => {\r\n            const lastMessage = MessagesService.getLastMessageFromConversation(conversation.id);\r\n            lastMessage.then((messageResponse) => {\r\n                allContacts.push({\r\n                    ...userResponse.data,\r\n                    conversationId: conversation.id,\r\n                    lastMessage: messageResponse.data\r\n                }) \r\n            })\r\n          })\r\n        } catch (err) {\r\n          console.log('Could not retrieve information!')\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(conversations.length !== 0) {\r\n            const allContacts = [];\r\n            conversations.map((conv) => {\r\n                if(conv.participantOneId !== currentUser.id) getNewContactDetails(conv, 'one', allContacts)\r\n                else getNewContactDetails(conv, 'two', allContacts)\r\n            })\r\n\r\n            const timeout = setTimeout(() => {\r\n                setContacts(allContacts);\r\n            }, 1000)        \r\n            \r\n            return () => {\r\n                clearTimeout(timeout);\r\n            }\r\n        }\r\n    }, [conversations, currentUser.id])\r\n\r\n    const toggleDarkMode = () => {\r\n        const body = document.querySelector('body');\r\n        if( body.classList.contains('dark-mode')) {\r\n            body.classList.remove('dark-mode')\r\n        } else {\r\n            body.classList.add('dark-mode')\r\n        }\r\n    }\r\n\r\n    /* onlineUsersIds.find(id => contact.id === id)  */\r\n\r\n    return (\r\n        <div className=\"col-12 col-md-4 col-lg-5 col-xl-3 px-0 messages-page__list-scroll\">\r\n            <div className=\"messages-page__header mb-0 px-4 pt-3 pb-3\">\r\n                <span className=\"messages-page__title\">\r\n                    {contactForm \r\n                        ? <div style={{ cursor: 'pointer'}} onClick={hideAddContactForm}>\r\n                            <svg style={{marginBottom: '3px'}} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M16.67 0l2.83 2.829-9.339 9.175 9.339 9.167-2.83 2.829-12.17-11.996z\"/></svg> Go Back\r\n                        </div>\r\n                        : currentUser.username\r\n                    }\r\n                </span>\r\n                <div className=\"messages-page__dark-mode-toogler\" onClick={toggleDarkMode}>\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon svg-icon--dark-mode\" viewBox=\"0 0 49.7 49.7\">\r\n                        <path d=\"M25.4,49.7A25.6,25.6,0,0,1,1.3,32.3,25.6,25.6,0,0,1,17.3.1a2,2,0,0,1,2.1.5,2.2,2.2,0,0,1,.5,2.1,19.9,19.9,0,0,0-1.2,6.8A21,21,0,0,0,25,24.7,21,21,0,0,0,40.2,31h0a20.9,20.9,0,0,0,6.9-1.2,2,2,0,0,1,2.5,2.5,25.8,25.8,0,0,1-16,16.1A28.7,28.7,0,0,1,25.4,49.7ZM15,5.5A21.4,21.4,0,0,0,5.1,31.1,21.5,21.5,0,0,0,15.9,43.4a21.2,21.2,0,0,0,28.3-8.8,17.5,17.5,0,0,1-4,.4h0a24.9,24.9,0,0,1-18-7.5,24.9,24.9,0,0,1-7.5-18A26.9,26.9,0,0,1,15,5.5Z\" fill=\"#f68b3c\" />\r\n                    </svg>\r\n                </div>\r\n            </div>\r\n            <div className=\"messages-page__search mb-0 px-3 pb-3\">\r\n                <div className=\"custom-form__search-wrapper\">\r\n                    <input \r\n                        type=\"text\" \r\n                        className=\"form-control custom-form\" \r\n                        id=\"search\" \r\n                        placeholder={`${contactForm  ? 'Search for a user...' : 'Find a user or a message…'}`} \r\n                        autoComplete=\"off\"\r\n                        onChange={handleInputChange}    \r\n                        ref={inputRef}\r\n                    />\r\n                    <button type=\"submit\" className=\"custom-form__search-submit\">\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon svg-icon--search\" viewBox=\"0 0 46.6 46.6\">\r\n                            <path d=\"M46.1,43.2l-9-8.9a20.9,20.9,0,1,0-2.8,2.8l8.9,9a1.9,1.9,0,0,0,1.4.5,2,2,0,0,0,1.5-.5A2.3,2.3,0,0,0,46.1,43.2ZM4,21a17,17,0,1,1,33.9,0A17.1,17.1,0,0,1,33,32.9h-.1A17,17,0,0,1,4,21Z\" fill=\"#f68b3c\" />\r\n                        </svg>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            <ul className=\"messages-page__list pb-5 px-1 px-md-3\">\r\n                {\r\n                    contactForm \r\n                        ? filteredList.map((user) => {\r\n                            return  <li \r\n                                        key={user.id}\r\n                                        className={`\r\n                                            messaging-member messaging-member--new \r\n                                            ${user.status === 'online' \r\n                                                ? 'messaging-member--online' \r\n                                                : ''} \r\n                                            ${currentChatContact && \r\n                                                currentChatContact.id === user.id \r\n                                                    ? 'messaging-member--active' \r\n                                                    : ''}`}\r\n                                        onClick={() => addToContacts(user)}\r\n                                    >\r\n                                        <div className=\"messaging-member__wrapper\">\r\n                                            <div className=\"messaging-member__avatar\">\r\n                                                <img src={user.profilePicture ? user.profilePicture : './avatar_placeholder.png'} alt={user.username} loading=\"lazy\"/>\r\n                                                <div className=\"user-status\"></div>\r\n                                            </div>\r\n                                            <span className=\"messaging-member__name\">{user.username}</span>\r\n                                            <span className=\"messaging-member__message\">Click to add user to contact list!</span>\r\n                                        </div>\r\n                                    </li>\r\n                        })\r\n                        : realTimeContacts.length === 0\r\n                            ? <div>\r\n                                <div style={{marginTop: '10px', textAlign: 'center'}}>No conversations yet...</div>\r\n                                <AddNewContact showAddContactForm={showAddContactForm}/>\r\n                            </div>\r\n                            : realTimeContacts.map(contact => {\r\n                                return  <li \r\n                                            key={contact.id}\r\n                                            className={`\r\n                                                messaging-member \r\n                                                ${contact.status === 'online'\r\n                                                    ? 'messaging-member--online' \r\n                                                    : ''} \r\n                                                ${currentChatContact && \r\n                                                    currentChatContact.id === contact.id \r\n                                                        ? 'messaging-member--active' \r\n                                                        : ''}`} // add  messaging-member--new if has new message\r\n                                            onClick={() => changeActiveUser(contact)}\r\n                                        >\r\n                                            <div className=\"messaging-member__wrapper\">\r\n                                                <div className=\"messaging-member__avatar\">\r\n                                                    <img src={contact.profilePicture ? contact.profilePicture : './avatar_placeholder.png'} alt={contact.username} loading=\"lazy\"/>\r\n                                                    <div className=\"user-status\"></div>\r\n                                                </div>\r\n                                                <span className=\"messaging-member__name\">{contact.username}</span>\r\n                                                <span className=\"messaging-member__message\">{contact?.lastMessage?.body ? contact?.lastMessage?.body : 'No messages yet'}</span>\r\n                                            </div>\r\n                                        </li>\r\n                        })\r\n                }\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MessageList\r\n","export const getQueryParam = (key) => {\r\n    const url = new URL(window.location.href);\r\n    return url.searchParams.get(key) || '';\r\n};\r\n\r\nexport default {\r\n    getQueryParam,\r\n}","import React, {useRef, useState, useEffect} from 'react'\r\nimport {getQueryParam} from '../utils/utils'\r\nimport MessagesService from '../services/messages.service'\r\n\r\nfunction ChatContent({messages, setMessages, sendMessage, currentUser, currentChatContact, currentConversation, logOut}) {\r\n    const messageRef = useRef();\r\n\r\n    useEffect(() => {\r\n        // get all messages from this conversation : currentConversation\r\n        MessagesService.getAllMessagesFromConversation(currentConversation)\r\n            .then((resp) => setMessages(resp.data))\r\n            .catch((err) => console.log(err))\r\n    }, [currentConversation])\r\n    \r\n    const send = () => {\r\n        if(messageRef.current.value && currentChatContact) {\r\n            const conversationId = getQueryParam('conversation');\r\n            if(conversationId) {\r\n                const newMessage = {\r\n                    conversationId: conversationId,\r\n                    from: currentUser.id,\r\n                    to: currentChatContact.id,\r\n                    body: messageRef.current.value\r\n                }\r\n                sendMessage(newMessage);\r\n                messageRef.current.value = '';\r\n            }\r\n        }\r\n    }\r\n\r\n    const showChatDetails = () => {\r\n        const profile = document.querySelector('.user-profile');\r\n        const body = document.querySelector('body');\r\n        if(body.clientWidth <= 1199) {\r\n            profile.classList.add('user-profile--large');\r\n            profile.classList.add('user-profile--show');\r\n        }\r\n    }\r\n\r\n    const chatPrevious = () => {\r\n        const chat = document.querySelector('.chat');\r\n\t\tchat.classList.remove('chat--show');\r\n    }\r\n\r\n    useEffect(() => {\r\n        const chat = document.querySelector('.chat');\r\n        if(window.innerWidth <= 764) chat.classList.add('chat--mobile'); \r\n        else chat.classList.remove('chat--mobile');\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            const chat = document.querySelector('.chat');\r\n            if(window.innerWidth <= 764) chat.classList.add('chat--mobile'); \r\n            else chat.classList.remove('chat--mobile');\r\n        }\r\n        window.addEventListener('resize', handleResize)\r\n    })\r\n\r\n    const handleFormSubmit = (e) => {\r\n        e.preventDefault();\r\n    }\r\n\r\n    return (\r\n        <div className=\"chat col-12 col-md-8 col-lg-7 col-xl-6 px-0 pl-md-1\" style={{display: 'block'}}>\r\n            <div className=\"chat__container\">\r\n                <div className=\"chat__wrapper py-2 pt-mb-2 pb-md-3\">\r\n                    <div className={`chat__messaging ${currentChatContact && currentChatContact?.status === 'online' && 'messaging-member--online '} pb-2 pb-md-2 pl-2 pl-md-4 pr-2`}>\r\n                        <div className=\"chat__previous d-flex d-md-none\" onClick={chatPrevious}>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon svg-icon--previous\" viewBox=\"0 0 45.5 30.4\">\r\n                                <path d=\"M43.5,13.1H7l9.7-9.6A2.1,2.1,0,1,0,13.8.6L.9,13.5h0L.3,14v.6c0,.1-.1.1-.1.2v.4a2,2,0,0,0,.6,1.5l.3.3L13.8,29.8a2.1,2.1,0,1,0,2.9-2.9L7,17.2H43.5a2,2,0,0,0,2-2A2.1,2.1,0,0,0,43.5,13.1Z\" fill=\"#f68b3c\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div className=\"chat__notification d-flex d-md-none chat__notification--new\">\r\n                            <span>1</span>\r\n                        </div>\r\n                        <div className=\"chat__infos pl-2 pl-md-0\">\r\n                            <div className=\"chat-member__wrapper\" data-online=\"true\">\r\n                                <div className=\"chat-member__avatar\">\r\n                                    <img src={!currentChatContact?.profilePicture && './avatar_placeholder.png'} alt={currentChatContact && currentChatContact.username} loading=\"lazy\"/>\r\n                                    <div className=\"user-status user-status--large\"></div>\r\n                                </div>\r\n                                <div className=\"chat-member__details\">\r\n                                    <span className=\"chat-member__name\">{currentChatContact ? currentChatContact.username : 'John Doe'}</span>\r\n                                    <span className=\"chat-member__status\">{currentChatContact ? currentChatContact?.status : 'Offline'}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"chat__actions mr-2 \">\r\n                            <ul className=\"m-0\">\r\n                                <li>\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon\" viewBox=\"0 0 24 24\" onClick={logOut}>\r\n                                        <path d=\"M10 2v2h12v16h-12v2h14v-20h-14zm0 7.408l2.963 2.592-2.963 2.592v-1.592h-8v-2h8v-1.592zm-2-4.408v4h-8v6h8v4l8-7-8-7z\"/>\r\n                                    </svg>\r\n                                </li>\r\n                                <li>\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon\" viewBox=\"0 0 48 48\">\r\n                                        <path d=\"M38.4,48c-2.1,0-5.1-.8-9.5-3.2a62.9,62.9,0,0,1-14.6-11A61.7,61.7,0,0,1,3.2,19C-.9,11.8-.3,8.5.7,6.4A9.7,9.7,0,0,1,4.8,2,21.1,21.1,0,0,1,7.8.4h.3c1.8-.7,3-.3,4.9,1.5h.1a40.1,40.1,0,0,1,5.4,8.2c1.3,2.6,1.6,4.3-.2,6.9l-.5.6c-.8,1-.8,1.2-.8,1.6s1.9,3.4,5.2,6.7S28,30.8,28.8,31s.6,0,1.6-.8l.7-.4c2.5-1.9,4.2-1.6,6.8-.3A40.6,40.6,0,0,1,46.1,35h.1c1.8,1.9,2.2,3.1,1.5,4.9v.2h0a21.1,21.1,0,0,1-1.6,3,10,10,0,0,1-4.3,4.1A7.7,7.7,0,0,1,38.4,48ZM9.5,4.1H9.2L6.9,5.4H6.8A6.3,6.3,0,0,0,4.3,8.1c-.3.7-1.2,2.6,2.4,9A58.9,58.9,0,0,0,17.1,30.9,58.2,58.2,0,0,0,30.9,41.3c6.4,3.6,8.4,2.7,9.1,2.4a6.7,6.7,0,0,0,2.5-2.5.1.1,0,0,0,.1-.1c.5-.8.9-1.6,1.3-2.4v-.2l-.5-.6a35.4,35.4,0,0,0-7.3-4.8c-1.7-.8-1.8-.8-2.7-.1l-.6.4A5.3,5.3,0,0,1,28,34.9c-2.9-.6-7.4-4.9-8.7-6.2s-5.6-5.8-6.2-8.7.6-3.6,1.5-4.8l.4-.6c.7-.9.8-1-.1-2.7a35.4,35.4,0,0,0-4.8-7.3Z\" fill=\"#f68b3c\" />\r\n                                    </svg>\r\n                                </li>\r\n                                <li>\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon\" viewBox=\"0 0 46.8 47.4\">\r\n                                        <path d=\"M35.8,47.4H11a11,11,0,0,1-11-11V11.6A11,11,0,0,1,11,.6h8.8a2,2,0,1,1,0,4H11a7,7,0,0,0-7,7V36.4a7,7,0,0,0,7,7H35.8a7,7,0,0,0,7-7v-9a2,2,0,1,1,4,0v9A11,11,0,0,1,35.8,47.4Z\" fill=\"#f68b3c\" />\r\n                                        <path d=\"M36.6,20.4A10.2,10.2,0,1,1,46.8,10.2,10.2,10.2,0,0,1,36.6,20.4ZM36.6,4a6.2,6.2,0,1,0,6.2,6.2A6.2,6.2,0,0,0,36.6,4Z\" fill=\"#f68b3c\" />\r\n                                    </svg>\r\n                                </li>\r\n                                <li className=\"chat__details d-flex d-xl-none\" onClick={showChatDetails}>\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon\" viewBox=\"0 0 42.2 11.1\">\r\n                                        <g>\r\n                                            <circle cx=\"5.6\" cy=\"5.6\" r=\"5.6\" fill=\"#d87232\" />\r\n                                            <circle cx=\"21.1\" cy=\"5.6\" r=\"5.6\" fill=\"#d87232\" />\r\n                                            <circle cx=\"36.6\" cy=\"5.6\" r=\"5.6\" fill=\"#d87232\" />\r\n                                        </g>\r\n                                    </svg>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"chat__content pt-4 px-3\">\r\n                        {/* <div className=\"chat__time\">Yesterday at 16:43</div> */}\r\n                        <ul className=\"chat__list-messages\">\r\n                            {currentChatContact \r\n                                ? messages.map((message, index) => (\r\n                                    <li key={index}>\r\n                                        <div className={`chat__bubble ${message.from === currentUser.id ? 'chat__bubble--me' : 'chat__bubble--you'}`}>\r\n                                            {message.body}\r\n                                        </div>\r\n                                    </li>\r\n                                )) \r\n                                : <p style={{textAlign: 'center', marginTop: '30px'}}>Open a conversation</p>\r\n                            }               \r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"chat__send-container px-2 px-md-3 pt-1 pt-md-3\">\r\n                        <form className=\"custom-form__send-wrapper\" onSubmit={handleFormSubmit}>\r\n                            <input type=\"text\" className=\"form-control custom-form\" id=\"message\" placeholder=\"Send a message …\" autoComplete=\"off\" ref={messageRef}/>\r\n                            <div className=\"custom-form__send-img\">\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon svg-icon--send-img\" viewBox=\"0 0 45.7 45.7\">\r\n                                    <path d=\"M6.6,45.7A6.7,6.7,0,0,1,0,39.1V6.6A6.7,6.7,0,0,1,6.6,0H39.1a6.7,6.7,0,0,1,6.6,6.6V39.1h0a6.7,6.7,0,0,1-6.6,6.6ZM39,4H6.6A2.6,2.6,0,0,0,4,6.6V39.1a2.6,2.6,0,0,0,2.6,2.6H39.1a2.6,2.6,0,0,0,2.6-2.6V6.6A2.7,2.7,0,0,0,39,4Zm4.7,35.1Zm-4.6-.4H6.6a2.1,2.1,0,0,1-1.8-1.1,2,2,0,0,1,.3-2.1l8.1-10.4a1.8,1.8,0,0,1,1.5-.8,2.4,2.4,0,0,1,1.6.7l4.2,5.1,6.6-8.5a1.8,1.8,0,0,1,1.6-.8,1.8,1.8,0,0,1,1.5.8L40.7,35.5a2,2,0,0,1,.1,2.1A1.8,1.8,0,0,1,39.1,38.7Zm-17.2-4H35.1l-6.5-8.6-6.5,8.4C22,34.6,22,34.7,21.9,34.7Zm-11.2,0H19l-4.2-5.1Z\" fill=\"#f68b3c\" />\r\n                                </svg>\r\n                            </div>\r\n                            <div className=\"custom-form__send-emoji\">\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon svg-icon--send-emoji\" viewBox=\"0 0 46.2 46.2\">\r\n                                    <path d=\"M23.1,0A23.1,23.1,0,1,0,46.2,23.1,23.1,23.1,0,0,0,23.1,0Zm0,41.6A18.5,18.5,0,1,1,41.6,23.1,18.5,18.5,0,0,1,23.1,41.6Zm8.1-20.8a3.5,3.5,0,0,0,3.5-3.5,3.5,3.5,0,0,0-7,0,3.5,3.5,0,0,0,3.5,3.5ZM15,20.8a3.5,3.5,0,0,0,3.5-3.5A3.5,3.5,0,0,0,15,13.9a3.4,3.4,0,0,0-3.4,3.4A3.5,3.5,0,0,0,15,20.8Zm8.1,15a12.6,12.6,0,0,0,10.5-5.5,1.7,1.7,0,0,0-1.3-2.6H14a1.7,1.7,0,0,0-1.4,2.6A12.9,12.9,0,0,0,23.1,35.8Z\" fill=\"#f68b3c\" />\r\n                                </svg>\r\n                            </div>\r\n                            <button type=\"submit\" className=\"custom-form__send-submit\"  onClick={send}>\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon svg-icon--send\" viewBox=\"0 0 45.6 45.6\">\r\n                                    <g>\r\n                                        <path d=\"M20.7,26.7a1.4,1.4,0,0,1-1.2-.6,1.6,1.6,0,0,1,0-2.4L42.6.5a1.8,1.8,0,0,1,2.5,0,1.8,1.8,0,0,1,0,2.5L21.9,26.1A1.6,1.6,0,0,1,20.7,26.7Z\" fill=\"#d87232\" />\r\n                                        <path d=\"M29.1,45.6a1.8,1.8,0,0,1-1.6-1L19.4,26.2,1,18.1a1.9,1.9,0,0,1-1-1.7,1.8,1.8,0,0,1,1.2-1.6L43.3.1a1.7,1.7,0,0,1,1.8.4,1.7,1.7,0,0,1,.4,1.8L30.8,44.4a1.8,1.8,0,0,1-1.6,1.2ZM6.5,16.7l14.9,6.6a2,2,0,0,1,.9.9l6.6,14.9L41,4.6Z\" fill=\"#d87232\" />\r\n                                    </g>\r\n                                </svg>\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ChatContent\r\n","import React, {useEffect} from 'react'\r\nimport AddNewContact from './AddNewContact'\r\nimport ConversationsService from '../services/conversations.service'\r\n\r\nfunction ChatInfos({currentConversation, currentChatContact, showAddContactForm}) {\r\n\r\n    const closeUserProfile = () => {\r\n        const profile = document.querySelector('.user-profile');\r\n        profile.classList.remove('user-profile--show');\r\n    }\r\n\r\n    useEffect(() => {\r\n        const profile = document.querySelector('.user-profile');\r\n        if(window.innerWidth <= 1200) profile.classList.add('user-profile--large'); \r\n        else profile.classList.remove('user-profile--large');\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            const profile = document.querySelector('.user-profile');\r\n            if(window.innerWidth <= 1200) profile.classList.add('user-profile--large'); \r\n            else profile.classList.remove('user-profile--large');\r\n        }\r\n        window.addEventListener('resize', handleResize)\r\n    })\r\n    \r\n    const deleteContact = () => {\r\n        ConversationsService.deleteConversation(currentConversation)\r\n            .then((resp) => {\r\n                window.location.reload(false);\r\n            })\r\n            .catch((err) => {alert('Could not delete conversation')})\r\n    }\r\n\r\n    return (\r\n        <div className=\"col-12 col-md-5 col-lg-4 col-xl-3 px-4 px-sm-5 px-lg-4 user-profile user\" style={{display: 'block'}}>\r\n            <div className=\"user-profile__close d-flex d-xl-none\" onClick={closeUserProfile}>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"svg-icon\" viewBox=\"0 0 38.8 38.9\">\r\n                    <g>\r\n                        <path d=\"M2,38.9a1.9,1.9,0,0,1-1.4-.5,2.1,2.1,0,0,1,0-2.9L35.4.6a1.9,1.9,0,0,1,2.8,0,1.9,1.9,0,0,1,0,2.8L3.4,38.4A1.9,1.9,0,0,1,2,38.9Z\" fill=\"#d87232\" />\r\n                        <path d=\"M36.8,38.9a1.9,1.9,0,0,1-1.4-.5L.6,3.4A1.9,1.9,0,0,1,.6.6,1.9,1.9,0,0,1,3.4.6L38.2,35.5a2.1,2.1,0,0,1,0,2.9A1.9,1.9,0,0,1,36.8,38.9Z\" fill=\"#d87232\" />\r\n                    </g>\r\n                </svg>\r\n            </div>\r\n            <div className=\"user-profile__wrapper\">\r\n                <div className=\"user-profile__avatar\">\r\n                    <img src={currentChatContact && currentChatContact.profilePicture ? currentChatContact.profilePicture : './avatar_placeholder.png'} alt={currentChatContact ? currentChatContact.username : 'image'} loading=\"lazy\"/>\r\n                </div>\r\n                <div className=\"user-profile__details mt-1\">\r\n                    <span className=\"user-profile__name\">{currentChatContact ? currentChatContact.username : 'John Doe'}</span>\r\n                    <span className=\"user-profile__phone\">(025) 015-234-567</span>\r\n                    <span className=\"user-profile__location\">New York, United States</span>\r\n                </div>\r\n                <div className=\"user-profile__description\">\r\n                    <p>Fly me to the moon 🌙 If you feel like your life is a routine, step back and take a deep breath.</p>\r\n                </div>\r\n                <div className=\"user-profile__learning mt-4\">\r\n                    <span className=\"user-profile__label\">Social Medias</span>\r\n                    <ul className=\"user-profile__tags user-profile__tags--primary mt-2\">\r\n                        {currentChatContact \r\n                            && currentChatContact.socialMedias \r\n                                ? currentChatContact.socialMedias.map(social => {\r\n                                    return <li key={social.name}><a href={social.link} target=\"_blank\">{social.name}</a></li>\r\n                                })\r\n                                : <li><a href='' target=\"_blank\">No social media added :(</a></li>\r\n                        }\r\n                    </ul>\r\n                </div>\r\n                <div className=\"user-profile__hobbies\">\r\n                    <span className=\"user-profile__label\">Activities</span>\r\n                    <ul className=\"user-profile__tags user-profile__tags--secondary mt-2\">\r\n                        {currentChatContact && currentChatContact.activities?.map((activity, index) => {\r\n                            return <li key={index}>{activity}</li>\r\n                        })}\r\n                    </ul>\r\n                </div>\r\n                <AddNewContact showAddContactForm={showAddContactForm}/>\r\n                {currentChatContact && <div style={{padding: '10px 30px', borderRadius: '20px', background:'tomato', color: '#fff', maxWidth: '200px', margin: '20px auto', cursor: 'pointer'}} onClick={deleteContact}>Delete Contact</div>}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ChatInfos\r\n","// react\r\nimport React, {useEffect, useRef, useState} from 'react'\r\n// components\r\nimport MessageList from './MessageList'\r\nimport ChatContent from './ChatContent'\r\nimport ChatInfos from './ChatInfos'\r\nimport UserService from '../services/auth.service';\r\n// redux \r\nimport { useSelector } from \"react-redux\";\r\n// sockets\r\nimport SockJS from 'sockjs-client'\r\nimport Stomp from 'stompjs';\r\n// router\r\nimport { Redirect } from 'react-router-dom';\r\n// styles\r\nimport '../styles/Chat.scss'\r\n// utils\r\n/* import {getQueryParam} from '../utils/utils'\r\nimport UserService from \"../services/user.service\"; */\r\nimport EventBus from \"../common/EventBus\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport BASE_URL from '../utils/baseUrl';\r\n\r\nconst SOCKET_URL = BASE_URL + 'ws-message';\r\n\r\nfunction Chat() {\r\n\tconst { user: currentUser } = useSelector((state) => state.auth);\r\n\tlet history = useHistory();\r\n\tconst [status, setStatus] = useState('offline')\r\n\r\n\tconst CONNECTED_USER = {\r\n\t\tid: currentUser.id,\r\n        profilePicture: 'https://randomuser.me/api/portraits/thumb/men/2.jpg',\r\n        username: currentUser.username,\r\n        lastMessage: 'Yes, I need your help with the project, it need it done by tomorrow 😫',\r\n        status: status,\r\n        conversations: [\r\n            'stppvuuidjkel123'\r\n        ],\r\n        description: 'Fly me to the moon 🌙 If you feel like your life is a routine, step back and take a deep breath.',\r\n        socialMedias: [\r\n            {\r\n                name: 'Instagram',\r\n                link: '#'\r\n            },\r\n            {\r\n                name: 'Codepen',\r\n                link: '#'\r\n            },\r\n            {\r\n                name: 'Linkedin',\r\n                link: '#'\r\n            },\r\n        ],\r\n        activities: [\r\n            'Biking',\r\n            'Cooking',\r\n            'Travelling',\r\n            'Graphic Design'\r\n        ]\r\n\t}\r\n\r\n\tconst [currentConversation, setCurrentConversation] = useState(null);\r\n\tconst [messages, setMessages] = useState([]);\r\n\tconst [contactForm, setContactForm] = useState(false);\r\n\tconst [onlineUsersIds, setOnlineUsersIds] = useState([]);\r\n\t\r\n\tconst ws = useRef(null);\r\n\tconst stomp = useRef(null);\r\n\t\r\n\tlet messagesSubscriptions = [];\r\n\tlet onlineUsersIds2 = []\r\n\tconst [currentChatContact, setCurrentChatContact] = useState(null);\r\n\r\n\tuseEffect(() => {\r\n\t\t\tws.current = new SockJS(SOCKET_URL);\r\n\t\t\tstomp.current = Stomp.over(ws.current);\r\n\t\t\tstomp.current.reconnect_delay = 5000;\r\n\t\t\t\r\n\t\t\tstomp.current.connect({}, frame => {\r\n\t\t\t\tconst connectedUser = {\r\n\t\t\t\t\tuserId: currentUser.id\r\n\t\t\t\t}\r\n\t\t\t\tstomp.current.send(`/app/send/online-user`, {}, JSON.stringify(connectedUser));\r\n\t\t\t\tUserService.updateStatus(currentUser.id, 'online')\r\n\t\t\t\t.then((resp) => console.log(resp))\r\n\r\n\t\t\t\tlet onlineContactsSubscription = stomp.current.subscribe(`/topic/online-user`, connectAction => {\r\n\t\t\t\t\tsetOnlineUsersIds(onlineUsersIds => [...onlineUsersIds, connectAction.body]);\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet offlineContactsSubscription = stomp.current.subscribe(`/topic/disconnect-user`, disconnectAction => {\r\n\t\t\t\t\tconst users = onlineUsersIds.filter(onlineUser => onlineUser.id !== disconnectAction.body);\r\n\t\t\t\t\tsetOnlineUsersIds(users);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet newMessagesSubscription = stomp.current.subscribe(`/topic/${currentConversation}`, chatActions => {\r\n\t\t\t\t\tconst newMessage = JSON.parse(chatActions.body);\r\n\t\t\t\t\tsetMessages(messages => [...messages, newMessage]);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tmessagesSubscriptions.push(onlineContactsSubscription);\r\n\t\t\t\tmessagesSubscriptions.push(offlineContactsSubscription);\r\n\t\t\t\tmessagesSubscriptions.push(newMessagesSubscription);\r\n\t\t\t});\r\n\r\n\t\t\treturn () => {\r\n\t\t\t\tws.current.close();\r\n\t\t\t};\r\n\t}, [currentConversation])\r\n\r\n\tconst disconnect = () => {\r\n\t\tconst disconnectedUser = {\r\n\t\t\tuserId: currentUser.id\r\n\t\t}\r\n\t\tstomp.current.send(`/app/send/disconnect-user`, {}, JSON.stringify(disconnectedUser));\r\n\t\tstomp.current.disconnect(frame => {\r\n\t\t\tif(messagesSubscriptions) messagesSubscriptions.map(subscription => subscription.unsubscribe())\r\n\t\t}, {})\r\n\t}\r\n\r\n\t// disconnect user on page close\r\n\twindow.onbeforeunload = () => {\r\n\t\tdisconnect();\r\n\t}\r\n\r\n\t// Must come after useRef and useEffect !!\r\n\tif (!currentUser) {\r\n\t\treturn <Redirect to=\"/login\" />;\r\n\t}\r\n\r\n\tconst sendMessage = (message) => {\r\n\t\tstomp.current.send(`/app/send/${currentConversation}`, {}, JSON.stringify(message));\r\n\t}\r\n\r\n\tconst hideAddContactForm = () => {\r\n\t\tsetContactForm(false)\r\n\t}\r\n\r\n\tconst showAddContactForm = () => {\r\n\t\tsetContactForm(true)\r\n\t\t// hide user profile\r\n\t\tconst userProfile = document.querySelector('.user-profile');\r\n\t\tuserProfile.classList.remove('user-profile--show');\r\n\t\t// hide chat\r\n\t\tconst chat = document.querySelector('.chat');\r\n\t\tchat.classList.remove('chat--show');\r\n\t}\r\n\r\n    const logOut = () => {\r\n\t\tEventBus.dispatch(\"logout\");\r\n        history.push('/');\r\n        window.location.reload();\r\n\t}\r\n\t\r\n    return (\r\n\t\t<div className=\"home-page__content messages-page\">\r\n\t\t\t<div className=\"container-fluid h-100\">\r\n\t\t\t\t<div className=\"row px-0 h-100\">\r\n\t\t\t\t\t<MessageList\r\n\t\t\t\t\t\tcurrentChatContact={currentChatContact}\r\n\t\t\t\t\t\tsetCurrentChatContact={setCurrentChatContact}\r\n\t\t\t\t\t\tcurrentUser={CONNECTED_USER}\r\n\t\t\t\t\t\tsetCurrentConversation={setCurrentConversation}\r\n\t\t\t\t\t\thideAddContactForm={hideAddContactForm}\r\n\t\t\t\t\t\tcontactForm={contactForm}\r\n\t\t\t\t\t\tshowAddContactForm={showAddContactForm}\r\n\t\t\t\t\t\tonlineUsersIds={onlineUsersIds}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ChatContent \r\n\t\t\t\t\t\tsendMessage={sendMessage}\r\n\t\t\t\t\t\tcurrentUser={CONNECTED_USER}\r\n\t\t\t\t\t\tcurrentChatContact={currentChatContact}\r\n\t\t\t\t\t\tmessages={messages}\r\n\t\t\t\t\t\tsetMessages={setMessages}\r\n\t\t\t\t\t\tcurrentConversation={currentConversation}\r\n\t\t\t\t\t\tlogOut={logOut}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ChatInfos\r\n\t\t\t\t\t\tcurrentChatContact={currentChatContact}\r\n\t\t\t\t\t\tshowAddContactForm={showAddContactForm}\r\n\t\t\t\t\t\tcurrentConversation={currentConversation}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n    )\r\n}\r\n\r\nexport default Chat\r\n","import React, { useState, useEffect } from \"react\";\r\n\r\nimport UserService from \"../services/user.service\";\r\nimport EventBus from \"../common/EventBus\";\r\nimport Chat from \"./Chat\";\r\n\r\nconst BoardUser = () => {\r\n  const [showChat, setShowChat] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    UserService.getUserBoard().then(\r\n      (response) => {\r\n        setShowChat(true);\r\n        console.log(response.data)\r\n      },\r\n      (error) => {\r\n        const _content =\r\n          (error.response &&\r\n            error.response.data &&\r\n            error.response.data.message) ||\r\n          error.message ||\r\n          error.toString();\r\n\r\n          setShowChat(false);\r\n          console.log(_content)\r\n\r\n        if (error.response && error.response.status === 401) {\r\n          EventBus.dispatch(\"logout\");\r\n        }\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  return (\r\n      <>\r\n        {showChat && <Chat/>}\r\n      </>\r\n    );\r\n  };\r\n  \r\n  export default BoardUser;","import { createBrowserHistory } from \"history\";\n\nexport const history = createBrowserHistory();\n","import React from \"react\";\nimport { history } from '../helpers/history';\n\nconst parseJwt = (token) => {\n  try {\n    return JSON.parse(atob(token.split(\".\")[1]));\n  } catch (e) {\n    return null;\n  }\n};\n\nconst AuthVerify = (props) => {\n  history.listen(() => {\n    const user = JSON.parse(localStorage.getItem(\"user\"));\n\n    if (user) {\n      const decodedJwt = parseJwt(user.accessToken);\n\n      if (decodedJwt.exp * 1000 < Date.now()) {\n        props.logOut();\n      }\n    }\n  });\n\n  return <div></div>;\n};\n\nexport default AuthVerify;\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Router, Switch, Route } from \"react-router-dom\";\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./App.css\";\n\nimport Login from \"./components/Login\";\nimport Register from \"./components/Register\";\nimport Home from \"./components/Home\";\nimport Profile from \"./components/Profile\";\nimport BoardUser from \"./components/BoardUser\";\n/* import BoardModerator from \"./components/BoardModerator\";\nimport BoardAdmin from \"./components/BoardAdmin\"; */\n\nimport { logout } from \"./actions/auth\";\nimport { clearMessage } from \"./actions/message\";\n\nimport { history } from \"./helpers/history\";\n\nimport AuthVerify from \"./common/AuthVerify\";\nimport EventBus from \"./common/EventBus\";\n/* import Navbar from \"./components/Navbar\"; */\n\nconst App = () => {\n  const [showModeratorBoard, setShowModeratorBoard] = useState(false);\n  const [showAdminBoard, setShowAdminBoard] = useState(false);\n\n  const { user: currentUser } = useSelector((state) => state.auth);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    history.push('/login')\n  }, [])\n\n  useEffect(() => {\n    history.listen((location) => {\n      dispatch(clearMessage()); // clear message when changing location\n    });\n  }, [dispatch]);\n\n  const logOut = useCallback(() => {\n    dispatch(logout());\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (currentUser) {\n      setShowModeratorBoard(currentUser.roles.includes(\"ROLE_MODERATOR\"));\n      setShowAdminBoard(currentUser.roles.includes(\"ROLE_ADMIN\"));\n    } else {\n      setShowModeratorBoard(false);\n      setShowAdminBoard(false);\n    }\n\n    EventBus.on(\"logout\", () => {\n      logOut();\n    });\n\n    return () => {\n      EventBus.remove(\"logout\");\n    };\n  }, [currentUser, logOut]);\n\n  return (\n      <Router history={history}>\n        <Switch>\n            <Route exact path={[\"/chat-app/\", \"/chat-app/home\"]} component={Home} />\n            <Route exact path=\"/chat-app/login\" component={Login} />\n            <Route exact path=\"/chat-app/register\" component={Register} />\n            <Route exact path=\"/chat-app/profile\" component={Profile} />\n            <Route path=\"/chat-app/chat\" component={BoardUser} />\n          </Switch>\n        <AuthVerify logOut={logOut}/>\n    </Router>\n  );\n};\n\nexport default App;\n","import { SET_MESSAGE, CLEAR_MESSAGE } from \"./types\";\n\nexport const setMessage = (message) => ({\n  type: SET_MESSAGE,\n  payload: message,\n});\n\nexport const clearMessage = () => ({\n  type: CLEAR_MESSAGE,\n});\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport store from \"./store\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can chađinge\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}